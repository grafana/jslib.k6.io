/*! For license information please see s3.js.LICENSE.txt */
(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function a(e,t,r){return(t=c(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}e.r(t),e.d(t,{AWSConfig:()=>w,AWSError:()=>N,DNSError:()=>q,GeneralError:()=>G,HTTP2Error:()=>B,InvalidAWSConfigError:()=>O,InvalidSignatureError:()=>Se,NetworkError:()=>U,S3Bucket:()=>Je,S3Client:()=>$e,S3MultipartUpload:()=>et,S3Object:()=>Ze,S3Part:()=>tt,S3ServiceError:()=>rt,TCPError:()=>H,TLSError:()=>M});var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"_protocol",void 0),a(this,"_hostname",void 0),a(this,"_port",void 0);var r=!t.startsWith("http://")&&!t.startsWith("https://")?"".concat(e.DEFAULT_PROTOCOL,"://").concat(t):t,o=r.match(/^https?:/),i=n(r.replace(/^https?:\/\//,"").split("/"),1)[0];this._protocol=o?o[0].slice(0,-1):e.DEFAULT_PROTOCOL,this._hostname=i.split(":")[0],this._port=i.split(":")[1]?parseInt(i.split(":")[1]):void 0}return t=e,(r=[{key:"copy",value:function(){return new e(this.href)}},{key:"host",get:function(){return this._port?"".concat(this._hostname,":").concat(this._port):this._hostname},set:function(e){var t=n(e.split(":"),2),r=t[0],o=t[1];this._hostname=r,this._port=o?parseInt(o):void 0}},{key:"hostname",get:function(){return this._hostname},set:function(e){this._hostname=e}},{key:"href",get:function(){return"".concat(this.protocol,"://").concat(this.host)},set:function(t){var r=t.match(/^https?:/),o=n(t.replace(/^https?:\/\//,"").split("/"),1)[0];this._protocol=r?r[0].slice(0,-1):e.DEFAULT_PROTOCOL,this._hostname=o.split(":")[0],this._port=o.split(":")[1]?parseInt(o.split(":")[1]):void 0}},{key:"port",get:function(){return this._port},set:function(e){this._port=e}},{key:"protocol",get:function(){return this._protocol},set:function(e){this._protocol=e}}])&&i(t.prototype,r),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,o}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t,r){return t=y(t),function(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,r||[],y(e).constructor):t.apply(e,r))}function f(e){var t="function"==typeof Map?new Map:void 0;return f=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(h())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&p(o,r.prototype),o}(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)},f(e)}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function b(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}a(s,"DEFAULT_PROTOCOL","https");var w=function(){function e(t){if(d(this,e),m(this,"region",void 0),m(this,"accessKeyId",void 0),m(this,"secretAccessKey",void 0),m(this,"sessionToken",void 0),m(this,"endpoint",void 0),!t.region||""===t.region)throw new O('invalid AWS region; reason: expected a valid AWS region name (e.g. "us-east-1"), got `'.concat(t.region,"`"));if(!t.accessKeyId||""===t.accessKeyId)throw new O("invalid AWS access key ID; reason: expected a non empty string, got `".concat(t.accessKeyId,"`"));if(t.accessKeyId.length<16||t.accessKeyId.length>128)throw new O("invalid AWS access key ID; reason: size should be between 16 and 128 characters, got ".concat(t.accessKeyId.length));if(!t.secretAccessKey||""===t.secretAccessKey)throw new O("invalid AWS secret access key; reason: expected a non empty string, got `".concat(t.secretAccessKey,"`"));this.region=t.region,this.accessKeyId=t.accessKeyId,this.secretAccessKey=t.secretAccessKey,void 0!==t.sessionToken&&(this.sessionToken=t.sessionToken),void 0!==t.endpoint&&("string"==typeof t.endpoint?this.endpoint=new s(t.endpoint):this.endpoint=t.endpoint)}return b(e,null,[{key:"fromEnvironment",value:function(t){return new e({region:__ENV.AWS_REGION,accessKeyId:__ENV.AWS_ACCESS_KEY_ID,secretAccessKey:__ENV.AWS_SECRET_ACCESS_KEY,sessionToken:__ENV.AWS_SESSION_TOKEN,endpoint:null==t?void 0:t.endpoint})}}])}(),O=function(e){function t(e){return d(this,t),l(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),b(t)}(f(Error));const P=require("k6/html");var E;function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function k(e,t,r){return t&&j(e.prototype,t),r&&j(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e,t,r){return t=D(t),function(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,x()?Reflect.construct(t,r||[],D(e).constructor):t.apply(e,r))}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}function A(e){var t="function"==typeof Map?new Map:void 0;return A=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(x())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&R(o,r.prototype),o}(e,arguments,D(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),R(r,e)},A(e)}function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function L(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}var N=function(e){function t(e,r){var n;return S(this,t),L(n=C(this,t,[e]),"code",void 0),n.name="AWSError",n.code=r,n}return _(t,e),k(t,null,[{key:"parseXML",value:function(e){var r=(0,P.parseHTML)(e);return new t(r.find("Message").text(),r.find("Code").text())}},{key:"parse",value:function(e){if("application/json"===e.headers["Content-Type"]){var r=e.json()||{};return new t(r.Message||r.message||r.__type||"An error occurred on the server side",e.headers["X-Amzn-Errortype"]||r.__type)}return t.parseXML(e.body)}}])}(A(Error)),U=function(e){function t(e,r){var n;return S(this,t),L(n=C(this,t,[Q[r]||"An unknown error occurred"]),"code",void 0),L(n,"name",void 0),n.name=e,n.code=r,n}return _(t,e),k(t)}(A(Error)),G=function(e){function t(e){return S(this,t),C(this,t,["GeneralError",e])}return _(t,e),k(t)}(U),q=function(e){function t(e){return S(this,t),C(this,t,["DNSError",e])}return _(t,e),k(t)}(U),H=function(e){function t(e){return S(this,t),C(this,t,["TCPError",e])}return _(t,e),k(t)}(U),M=function(e){function t(e){return S(this,t),C(this,t,["TLSError",e])}return _(t,e),k(t)}(U),B=function(e){function t(e){return S(this,t),C(this,t,["HTTP2Error",e])}return _(t,e),k(t)}(U),K=function(e){return e[e.GenericError=1e3]="GenericError",e[e.NonTCPNetworkError=1010]="NonTCPNetworkError",e[e.InvalidURL=1020]="InvalidURL",e[e.HTTPRequestTimeout=1050]="HTTPRequestTimeout",e}({}),W=function(e){return e[e.GenericDNSError=1100]="GenericDNSError",e[e.NoIPFound=1101]="NoIPFound",e[e.BlacklistedIP=1110]="BlacklistedIP",e[e.BlacklistedHostname=1111]="BlacklistedHostname",e}({}),z=function(e){return e[e.GenericTCPError=1200]="GenericTCPError",e[e.BrokenPipeOnWrite=1201]="BrokenPipeOnWrite",e[e.UnknownTCPError=1202]="UnknownTCPError",e[e.GeneralTCPDialError=1210]="GeneralTCPDialError",e[e.DialTimeoutError=1211]="DialTimeoutError",e[e.DialConnectionRefused=1212]="DialConnectionRefused",e[e.DialUnknownError=1213]="DialUnknownError",e[e.ResetByPeer=1220]="ResetByPeer",e}({}),F=function(e){return e[e.GeneralTLSError=1300]="GeneralTLSError",e[e.UnknownAuthority=1310]="UnknownAuthority",e[e.CertificateHostnameMismatch=1311]="CertificateHostnameMismatch",e}({}),X=function(e){return e[e.GenericHTTP2Error=1600]="GenericHTTP2Error",e[e.GeneralHTTP2GoAwayError=1610]="GeneralHTTP2GoAwayError",e}({}),Q=(L(L(L(L(L(L(L(L(L(L(E={},K.GenericError,"A generic error that isn’t any of the ones listed below"),K.NonTCPNetworkError,"A non-TCP network error - this is a placeholder and there is no error currently known to trigger it"),K.InvalidURL,"An invalid URL was specified"),K.HTTPRequestTimeout,"The HTTP request has timed out"),W.GenericDNSError,"A generic DNS error that isn’t any of the ones listed below"),W.NoIPFound,"No IP for the provided host was found"),W.BlacklistedIP,"Blacklisted IP was resolved or a connection to such was tried to be established"),W.BlacklistedHostname,"Blacklisted hostname using The Block Hostnames option"),z.GenericTCPError,"A generic TCP error that isn’t any of the ones listed below"),z.BrokenPipeOnWrite,"A “broken pipe” on write - the other side has likely closed the connection"),L(L(L(L(L(L(L(L(L(L(E,z.UnknownTCPError,"An unknown TCP error - We got an error that we don’t recognize but it is from the operating system and has errno set on it. The message in error includes the operation(write,read) and the errno, the OS, and the original message of the error"),z.GeneralTCPDialError,"General TCP dial error"),z.DialTimeoutError,"Dial timeout error - the timeout for the dial was reached"),z.DialConnectionRefused,"Dial connection refused - the connection was refused by the other party on dial"),z.DialUnknownError,"Dial unknown error"),z.ResetByPeer,"Reset by peer - the connection was reset by the other party, most likely a server"),F.GeneralTLSError,"General TLS error"),F.UnknownAuthority,"Unknown authority - the certificate issuer is unknown"),F.CertificateHostnameMismatch,"The certificate doesn’t match the hostname"),X.GenericHTTP2Error,"A generic HTTP/2 error that isn’t any of the ones listed below"),L(E,X.GeneralHTTP2GoAwayError,"A general HTTP/2 GoAway error"));const V=require("k6/crypto");var Y=e.n(V),$="X-Amz-Date",J="X-Amz-Signature",Z="X-Amz-Security-Token",ee="x-amz-content-sha256",te=$.toLowerCase(),re=J.toLowerCase(),ne=("X-Amz-Target".toLowerCase(),Z.toLowerCase()),oe="authorization",ie=[oe,te,"date"],ae="host",ce={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},se="aws4_request",ue="AWS4-HMAC-SHA256";function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function fe(e,t,r){return t=pe(t),function(e,t){if(t&&("object"==le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,he()?Reflect.construct(t,r||[],pe(e).constructor):t.apply(e,r))}function he(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(he=function(){return!!e})()}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}function ye(e,t){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ye(e,t)}function de(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ve(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ve(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){Pe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ee(n.key),n)}}function Oe(e,t,r){return t&&we(e.prototype,t),r&&we(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Pe(e,t,r){return(t=Ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){var t=function(e,t){if("object"!=le(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==le(t)?t:t+""}var Te=function(){return Oe((function e(t){var r=t.service,n=t.region,o=t.credentials,i=t.uriEscapePath,a=t.applyChecksum;ge(this,e),Pe(this,"service",void 0),Pe(this,"region",void 0),Pe(this,"credentials",void 0),Pe(this,"uriEscapePath",void 0),Pe(this,"applyChecksum",void 0),this.service=r,this.region=n,this.credentials=o,this.uriEscapePath="boolean"!=typeof i||i,this.applyChecksum="boolean"!=typeof a||a}),[{key:"sign",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=me(me({},{signingDate:new Date,unsignableHeaders:new Set,signableHeaders:new Set}),t),n=ke(r.signingDate),o=n.longDate,i=n.shortDate,a=r.signingService||this.service,c=r.signingRegion||this.region,s="".concat(i,"/").concat(c,"/").concat(a,"/").concat(se);e.headers[ae]||(e.headers[ae]=e.endpoint.hostname);for(var u=0,l=Object.keys(e.headers);u<l.length;u++){var f=l[u];ie.indexOf(f.toLowerCase())>-1&&delete e.headers[f]}e.headers[te]=o,this.credentials.sessionToken&&(e.headers[ne]=this.credentials.sessionToken),ArrayBuffer.isView(e.body)&&(e.body=e.body.buffer),e.body||(e.body="");var h=this.computePayloadHash(e);!function(e,t){e=e.toLowerCase();for(var r=0,n=Object.keys(t);r<n.length;r++)if(e===n[r].toLowerCase())return!0;return!1}(ee,e.headers)&&this.applyChecksum&&(e.headers[ee]=h);var p=this.computeCanonicalHeaders(e,r.unsignableHeaders,r.signableHeaders),y=this.calculateSignature(o,s,this.deriveSigningKey(this.credentials,a,c,i),this.createCanonicalRequest(e,p,h));e.headers[oe]="".concat(ue," ")+"Credential=".concat(this.credentials.accessKeyId,"/").concat(s,", ")+"SignedHeaders=".concat(Object.keys(p).sort().join(";"),", ")+"Signature=".concat(y);var d=e.endpoint.href;return e.path&&(d.endsWith("/")||e.path.startsWith("/")||(d+="/"),d+=e.path),e.query&&(d+="?".concat(this.serializeQueryParameters(e.query))),me({url:d},e)}},{key:"presign",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.signingDate,n=void 0===r?new Date:r,o=t.expiresIn,i=void 0===o?3600:o,a=t.unsignableHeaders,c=t.unhoistableHeaders,s=t.signableHeaders,u=t.signingRegion,l=t.signingService,f=ke(n),h=f.longDate,p=f.shortDate,y=u||this.region,d=l||this.service;if(i>604800)throw new Se("Signature version 4 presigned URLs can't be valid for more than 7 days");var v="".concat(p,"/").concat(y,"/").concat(d,"/").concat(se),b=this.moveHeadersToQuery(e,{unhoistableHeaders:c});b.headers[ae]||(b.headers[ae]=e.endpoint.hostname),this.credentials.sessionToken&&(b.query[Z]=this.credentials.sessionToken),b.query["X-Amz-Algorithm"]=ue,b.query["X-Amz-Credential"]="".concat(this.credentials.accessKeyId,"/").concat(v),b.query[$]=h,b.query["X-Amz-Expires"]=i.toString(10);var m=this.computeCanonicalHeaders(b,a,s);b.query["X-Amz-SignedHeaders"]=Object.keys(m).sort().join(";");var g=this.deriveSigningKey(this.credentials,d,y,p),w=this.computePayloadHash(e),O=this.createCanonicalRequest(b,m,w);b.query[J]=this.calculateSignature(h,v,g,O);var P,E=e.endpoint.href;b.path&&(E=null!==(P=E)&&void 0!==P&&P.endsWith("/")?E:E+"/",E+=b.path);return b.query&&(E+="?".concat(this.serializeQueryParameters(b.query))),me({url:E},b)}},{key:"createCanonicalRequest",value:function(e,t,r){var n=Object.keys(t).sort(),o=n.map((function(e){return"".concat(e,":").concat(t[e])})).join("\n"),i=n.join(";");return"".concat(e.method,"\n")+"".concat(this.computeCanonicalURI(e),"\n")+"".concat(this.computeCanonicalQuerystring(e),"\n")+"".concat(o,"\n\n")+"".concat(i,"\n")+"".concat(r)}},{key:"createStringToSign",value:function(e,t,r){var n=Y().sha256(r,"hex");return"".concat(ue,"\n")+"".concat(e,"\n")+"".concat(t,"\n")+"".concat(n)}},{key:"calculateSignature",value:function(e,t,r,n){var o=this.createStringToSign(e,t,n);return Y().hmac("sha256",r,o,"hex")}},{key:"deriveSigningKey",value:function(e,t,r,n){var o=e.secretAccessKey,i=Y().hmac("sha256","AWS4"+o,n,"binary"),a=Y().hmac("sha256",i,r,"binary"),c=Y().hmac("sha256",a,t,"binary");return Y().hmac("sha256",c,"aws4_request","binary")}},{key:"computeCanonicalURI",value:function(e){var t=e.path;if(this.uriEscapePath){var r,n=[],o=de(t.split("/"));try{for(o.s();!(r=o.n()).done;){var i=r.value;0!==(null==i?void 0:i.length)&&("."!==i&&(".."===i?n.pop():n.push(i)))}}catch(e){o.e(e)}finally{o.f()}var a=null!=t&&t.startsWith("/")?"/":"",c=n.join("/"),s=n.length>0&&null!=t&&t.endsWith("/")?"/":"",u="".concat(a).concat(c).concat(s);return encodeURIComponent(u).replace(/%2F/g,"/")}return t}},{key:"computeCanonicalQuerystring",value:function(e){var t,r=e.query,n=void 0===r?{}:r,o=[],i={},a=function(e){if(e.toLowerCase()===re)return 1;o.push(e);var t=n[e];"string"==typeof t?i[e]="".concat(je(e),"=").concat(je(t)):Array.isArray(t)&&(i[e]=t.slice(0).sort().reduce((function(t,r){return t.concat(["".concat(je(e),"=").concat(je(r))])}),[]).join("&"))},c=de(Object.keys(n).sort());try{for(c.s();!(t=c.n()).done;){a(t.value)}}catch(e){c.e(e)}finally{c.f()}return o.map((function(e){return i[e]})).filter((function(e){return e})).join("&")}},{key:"computeCanonicalHeaders",value:function(e,t,r){var n,o=e.headers,i={},a=de(Object.keys(o).sort());try{for(a.s();!(n=a.n()).done;){var c=n.value;if(null!=o[c]){var s=c.toLowerCase();(s in ce||null!=t&&t.has(s))&&(!r||r&&!r.has(s))||"string"==typeof o[c]&&(i[s]=o[c]=o[c].trim().replace(/\s+/g," "))}}}catch(e){a.e(e)}finally{a.f()}return i}},{key:"computePayloadHash",value:function(e){var t,r=e.headers,n=e.body;return r[ee]?r[ee]:null==n?"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855":"string"==typeof n||(t=n,"function"==typeof ArrayBuffer&&(t instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(t)))?Y().sha256(n,"hex").toLowerCase():ArrayBuffer.isView(n)?Y().sha256(n.buffer,"hex").toLowerCase():"UNSIGNED-PAYLOAD"}},{key:"moveHeadersToQuery",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=JSON.parse(JSON.stringify(e)),n=r.headers,o=r.query,i=void 0===o?{}:o,a=0,c=Object.keys(n);a<c.length;a++){var s,u=c[a],l=u.toLowerCase();"x-amz-"!==l.slice(0,6)||null!==(s=t.unhoistableHeaders)&&void 0!==s&&s.has(l)||(i[u]=n[u],delete n[u])}return me(me({},r),{},{headers:n,query:i})}},{key:"serializeQueryParameters",value:function(e,t){var r,n=[],o={},i=function(r){if(null!=t&&t.includes(r.toLowerCase()))return 1;n.push(r);var i=e[r];"string"==typeof i?o[r]="".concat(je(r),"=").concat(je(i)):Array.isArray(i)&&(o[r]=i.slice(0).sort().reduce((function(e,t){return e.concat(["".concat(je(r),"=").concat(je(t))])}),[]).join("&"))},a=de(Object.keys(e).sort());try{for(a.s();!(r=a.n()).done;){i(r.value)}}catch(e){a.e(e)}finally{a.f()}return n.map((function(e){return o[e]})).filter((function(e){return e})).join("&")}}])}(),Se=function(e){function t(e,r){var n;return ge(this,t),(n=fe(this,t,[e,r])).name="InvalidSignatureError",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(t,e),Oe(t)}(N);function je(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function ke(e){var t,r=(t=e,function(e){return"number"==typeof e?new Date(1e3*e):"string"==typeof e?Number(e)?new Date(1e3*Number(e)):new Date(e):e}(t).toISOString().replace(/\.\d{3}Z$/,"Z")).replace(/[-:]/g,"");return{longDate:r,shortDate:r.slice(0,8)}}const Ce=require("k6/http");var _e=e.n(Ce);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,De(n.key),n)}}function Re(e,t,r){return(t=De(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e){var t=function(e,t){if("object"!=Ae(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ae(t)?t:t+""}function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function Ie(){Ie=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:j(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",d="completed",v={};function b(){}function m(){}function g(){}var w={};u(w,a,(function(){return this}));var O=Object.getPrototypeOf,P=O&&O(O(x([])));P&&P!==r&&n.call(P,a)&&(w=P);var E=g.prototype=b.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Le(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function j(t,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=k(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?d:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=d,n.method="throw",n.arg=u.arg)}}}function k(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function x(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Le(t)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=u(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(S.prototype),u(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=x,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:x(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function Ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(r),!0).forEach((function(t){Ve(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ge(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function qe(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Ge(i,n,o,a,c,"next",e)}function c(e){Ge(i,n,o,a,c,"throw",e)}a(void 0)}))}}function He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ye(n.key),n)}}function Be(e,t,r){return t&&Me(e.prototype,t),r&&Me(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ke(e,t,r){return t=Fe(t),function(e,t){if(t&&("object"==Le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,We()?Reflect.construct(t,r||[],Fe(e).constructor):t.apply(e,r))}function We(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(We=function(){return!!e})()}function ze(){return ze="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Fe(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ze.apply(null,arguments)}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fe(e)}function Xe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qe(e,t)}function Qe(e,t){return Qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qe(e,t)}function Ve(e,t,r){return(t=Ye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ye(e){var t=function(e,t){if("object"!=Le(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Le(t)?t:t+""}var $e=function(e){function t(e){var r;return He(this,t),Ve(r=Ke(this,t,[e,"s3"]),"signature",void 0),r.signature=new Te({service:r.serviceName,region:r.awsConfig.region,credentials:{accessKeyId:r.awsConfig.accessKeyId,secretAccessKey:r.awsConfig.secretAccessKey,sessionToken:r.awsConfig.sessionToken},uriEscapePath:!1,applyChecksum:!0}),r}return Xe(t,e),Be(t,[{key:"listBuckets",value:(f=qe(Ie().mark((function e(){var t,r,n;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.signature.sign({method:"GET",endpoint:this.endpoint,path:"/",headers:{}},{}),e.next=4,_e().asyncRequest("GET",t.url,t.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:t.headers}));case 4:return r=e.sent,this.handleError(r,"ListBuckets"),n=[],(0,P.parseHTML)(r.body).find("Buckets").children().each((function(e,t){var r={};t.children().forEach((function(e){switch(e.nodeName()){case"name":Object.assign(r,{name:e.textContent()});break;case"creationdate":Object.assign(r,{creationDate:Date.parse(e.textContent())})}})),n.push(r)})),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"listObjects",value:(l=qe(Ie().mark((function e(t,r){var n,o,i;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.signature.sign({method:"GET",endpoint:this.endpoint,path:encodeURI("/".concat(t,"/")),query:{"list-type":"2",prefix:r||""},headers:{}},{}),e.next=4,_e().asyncRequest("GET",n.url,n.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:n.headers}));case 4:return o=e.sent,this.handleError(o,"ListObjectsV2"),i=[],(0,P.parseHTML)(o.body).find("Contents").each((function(e,t){var r={};t.children().forEach((function(e){switch(e.nodeName()){case"key":Object.assign(r,{key:e.textContent()});break;case"lastmodified":Object.assign(r,{lastModified:Date.parse(e.textContent())});break;case"etag":Object.assign(r,{etag:e.textContent()});break;case"size":Object.assign(r,{size:parseInt(e.textContent())});break;case"storageclass":Object.assign(r,{storageClass:e.textContent()})}})),i.push(r)})),e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"getObject",value:(u=qe(Ie().mark((function e(t,r){var n,o,i,a,c,s=arguments;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:{},i=this.signature.sign({method:"GET",endpoint:this.endpoint,path:encodeURI("/".concat(t,"/").concat(r)),headers:Ue({},o)},{}),a="text","Accept"in o&&void 0!==o.Accept&&"application/octet-stream"===o.Accept&&(a="binary"),e.next=7,_e().asyncRequest("GET",i.url,null,Ue(Ue({},this.baseRequestParams),{},{headers:i.headers,responseType:a}));case 7:return c=e.sent,this.handleError(c,"GetObject"),e.abrupt("return",new Ze(r,Date.parse(c.headers["Last-Modified"]),c.headers.ETag,parseInt(c.headers["Content-Length"]),null!==(n=c.headers["X-Amz-Storage-Class"])&&void 0!==n?n:"STANDARD",c.body));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"putObject",value:(s=qe(Ie().mark((function e(t,r,n,o){var i,a;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.signature.sign({method:"PUT",endpoint:this.endpoint,path:encodeURI("/".concat(t,"/").concat(r)),headers:Ue(Ue(Ue(Ue(Ue({Host:this.endpoint.host},(null==o?void 0:o.contentDisposition)&&{"Content-Disposition":o.contentDisposition}),(null==o?void 0:o.contentEncoding)&&{"Content-Encoding":o.contentEncoding}),(null==o?void 0:o.contentLength)&&{"Content-Length":o.contentLength}),(null==o?void 0:o.contentMD5)&&{"Content-MD5":o.contentMD5}),(null==o?void 0:o.contentType)&&{"Content-Type":o.contentType}),body:n},{}),e.next=4,_e().asyncRequest("PUT",i.url,i.body,Ue(Ue({},this.baseRequestParams),{},{headers:i.headers}));case 4:a=e.sent,this.handleError(a,"PutObject");case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return s.apply(this,arguments)})},{key:"deleteObject",value:(c=qe(Ie().mark((function e(t,r){var n,o,i;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="DELETE",o=this.signature.sign({method:n,endpoint:this.endpoint,path:encodeURI("/".concat(t,"/").concat(r)),headers:{}},{}),e.next=4,_e().asyncRequest(n,o.url,o.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:o.headers}));case 4:i=e.sent,this.handleError(i,"DeleteObject");case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"copyObject",value:(a=qe(Ie().mark((function e(t,r,n,o){var i,a,c;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.endpoint.copy()).hostname="".concat(n,".").concat(this.endpoint.hostname),a=this.signature.sign({method:"PUT",endpoint:i,path:encodeURI("/".concat(o)),headers:{"x-amz-copy-source":"".concat(t,"/").concat(r)}},{}),e.next=6,_e().asyncRequest("PUT",a.url,a.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:a.headers}));case 6:c=e.sent,this.handleError(c,"CopyObject");case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"createMultipartUpload",value:(i=qe(Ie().mark((function e(t,r){var n,o,i,a;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="POST",(o=this.endpoint.copy()).hostname="".concat(t,".").concat(this.endpoint.hostname),i=this.signature.sign({method:n,endpoint:o,path:encodeURI("/".concat(r)),headers:{},query:{uploads:""}},{}),e.next=6,_e().asyncRequest(n,i.url,i.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:i.headers}));case 6:return a=e.sent,this.handleError(a,"CreateMultipartUpload"),e.abrupt("return",new et(r,(0,P.parseHTML)(a.body).find("UploadId").text()));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"uploadPart",value:(o=qe(Ie().mark((function e(t,r,n,o,i){var a,c,s;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.endpoint.copy()).hostname="".concat(t,".").concat(this.endpoint.hostname),c=this.signature.sign({method:"PUT",endpoint:a,path:encodeURI("/".concat(r)),headers:{},body:i,query:{partNumber:"".concat(o),uploadId:"".concat(n)}},{}),e.next=6,_e().asyncRequest("PUT",c.url,c.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:c.headers}));case 6:return s=e.sent,this.handleError(s,"UploadPart"),e.abrupt("return",new tt(o,s.headers.Etag));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i){return o.apply(this,arguments)})},{key:"completeMultipartUpload",value:(n=qe(Ie().mark((function e(t,r,n,o){var i,a,c,s,u;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="POST",a="<CompleteMultipartUpload>".concat(o.map((function(e){return"<Part><PartNumber>".concat(e.partNumber,"</PartNumber><ETag>").concat(e.eTag,"</ETag></Part>")})).join(""),"</CompleteMultipartUpload>"),(c=this.endpoint.copy()).hostname="".concat(t,".").concat(this.endpoint.hostname),s=this.signature.sign({method:i,endpoint:c,path:encodeURI("/".concat(r)),headers:{},body:a,query:{uploadId:"".concat(n)}},{}),e.next=7,_e().asyncRequest(i,s.url,s.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:s.headers}));case 7:u=e.sent,this.handleError(u,"CompleteMultipartUpload");case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r,o){return n.apply(this,arguments)})},{key:"abortMultipartUpload",value:(r=qe(Ie().mark((function e(t,r,n){var o,i,a,c;return Ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="DELETE",(i=this.endpoint.copy()).hostname="".concat(t,".").concat(this.endpoint.hostname),a=this.signature.sign({method:o,endpoint:i,path:encodeURI("/".concat(r)),headers:{},query:{uploadId:"".concat(n)}},{}),e.next=6,_e().asyncRequest(o,a.url,a.body||null,Ue(Ue({},this.baseRequestParams),{},{headers:a.headers}));case 6:c=e.sent,this.handleError(c,"AbortMultipartUpload");case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"handleError",value:function(e,r){var n,o,i,a,c;if(!(n=t,o="handleError",i=this,c=ze(Fe(1&(a=3)?n.prototype:n),o,i),2&a?function(e){return c.apply(i,e)}:c)([e]))return!1;var s=e.error;if(301==e.status||s&&s.startsWith("301"))throw new rt("Resource not found","ResourceNotFound",r);var u=N.parseXML(e.body);if("AuthorizationHeaderMalformed"===u.code)throw new Se(u.message,u.code);throw new rt(u.message,u.code||"unknown",r)}}]);var r,n,o,i,a,c,s,u,l,f}(function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Re(this,"awsConfig",void 0),Re(this,"serviceName",void 0),Re(this,"baseRequestParams",{responseType:"text"}),Re(this,"_endpoint",void 0),this.awsConfig=t,this.serviceName=r,null!=t.endpoint&&(this._endpoint=t.endpoint)},(t=[{key:"endpoint",get:function(){return null==this._endpoint&&(this._endpoint=new s("https://".concat(this.serviceName,".").concat(this.awsConfig.region,".amazonaws.com"))),this._endpoint},set:function(e){this._endpoint=e}},{key:"handleError",value:function(e,t){var r=e.status,n=e.error_code,o=e.error;if(r>=200&&r<300&&""==o&&0===n)return!1;switch(n){case K.GenericError:case K.NonTCPNetworkError:case K.InvalidURL:case K.HTTPRequestTimeout:throw new G(n);case W.GenericDNSError:case W.NoIPFound:case W.BlacklistedIP:case W.BlacklistedHostname:throw new q(n);case z.GenericTCPError:case z.BrokenPipeOnWrite:case z.UnknownTCPError:case z.GeneralTCPDialError:case z.DialTimeoutError:case z.DialConnectionRefused:case z.DialUnknownError:case z.ResetByPeer:throw new H(n);case F.GeneralTLSError:case F.UnknownAuthority:case F.CertificateHostnameMismatch:throw new M(n);case X.GenericHTTP2Error:case X.GeneralHTTP2GoAwayError:throw new B(n)}return!0}}])&&xe(e.prototype,t),r&&xe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()),Je=Be((function e(t,r){He(this,e),Ve(this,"name",void 0),Ve(this,"creationDate",void 0),this.name=t,this.creationDate=r})),Ze=Be((function e(t,r,n,o,i,a){He(this,e),Ve(this,"key",void 0),Ve(this,"lastModified",void 0),Ve(this,"etag",void 0),Ve(this,"size",void 0),Ve(this,"storageClass",void 0),Ve(this,"data",void 0),this.key=t,this.lastModified=r,this.etag=n,this.size=o,this.storageClass=i,this.data=a})),et=Be((function e(t,r){He(this,e),Ve(this,"key",void 0),Ve(this,"uploadId",void 0),this.key=t,this.uploadId=r})),tt=Be((function e(t,r){He(this,e),Ve(this,"partNumber",void 0),Ve(this,"eTag",void 0),this.partNumber=t,this.eTag=r})),rt=function(e){function t(e,r,n){var o;return He(this,t),Ve(o=Ke(this,t,[e,r]),"operation",void 0),o.name="S3ServiceError",o.operation=n,o}return Xe(t,e),Be(t)}(N),nt=exports;for(var ot in t)nt[ot]=t[ot];t.__esModule&&Object.defineProperty(nt,"__esModule",{value:!0})})();
//# sourceMappingURL=s3.js.map